#http://cran.r-project.org/web/packages/IBrokers/IBrokers.pdf
#http://cran.r-project.org/web/packages/IBrokers/vignettes/RealTime.pdf
#http://cran.r-project.org/web/packages/IBrokers/vignettes/IBrokers.pdf
#http://artax.karlin.mff.cuni.cz/r-help/library/IBrokers/html/00Index.html
#https://www.rmetrics.org/files/Meielisalp2009/Presentations/Ryan.pdf
#http://interactivebrokers.github.io/#
tws <- twsConnect()
id <- reqIds(tws)
reqCurrentTime(tws)# Request The Current TWS Time
contract <- twsEquity('RARE')
reqContractDetails(tws,contract)
# retrieve all QQQQ contracts as a list
reqContractDetails(tws, twsOption(local="", right="", symbol="RARE"))
# retrieve only calls
reqContractDetails(tws, twsOption(local="", right="C", symbol="RARE"))
# retrieve only puts
reqContractDetails(tws, twsOption(local="", right="P", symbol="RARE"))
reqMktData(tws,contract)
fh <- file('d://out.dat',open='a')
reqMktData(tws, contract, file=fh)
Sys.sleep(10)
reqHistory(tws, Contract=contract)
reqHistoricalData(tws,contract)
reqMktDepth(tws,contract)
reqRealTimeBars(tws,contract)
twsSTK(contract)
twsDisconnect(tws)
reqMktData(tws, twsFUT("NDM5","GLOBEX","201505"))
reqMktData(tws, twsFuture("NDM5","GLOBEX","201505"))

 reqMktData(tws,
 Contract = twsSTK("RARE"),
 eventWrapper = eWrapper(TRUE),
 timeStamp=NULL)

reqMktData(tws, twsEquity("SBUX"), CALLBACK=NULL, file="D://SBUX.dat")
twsp <- twsConnect(filename="SBUX.dat")

To playback the saved data, call reqMktData again:
reqMktData(twsp)
reqMktData(twsp, playback=0)

reqMktDepth(tws, twsEquity("SBUX"), CALLBACK=NULL, file="D://SBUX.dat")
reqRealTimeBars(tws, twsEquity("SBUX"), C ALLBACK=NULL, file="D://SBUX.dat")
#NDX150508P04240000-SMART-OPT-USD
opt <- twsOption("NDX",expiry="150508", strike="4240", right="P")

